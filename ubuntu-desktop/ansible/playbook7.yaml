---
- name: Install MySQL and create database
  hosts: webservers
  become: yes
  become_method: sudo
  vars:
    mysql_root_password: yourpassword

  tasks:
    - name: Install MySQL
      apt:
        name: mysql-server
        state: present

    - name: Set MySQL root password
      mysql_user:
        login_user: root
        login_password: ""
        user: root
        password: "{{ mysql_root_password }}"
        host: localhost
        update_password: always
        check_implicit_admin: yes

    - name: Create database
      mysql_db:
        login_host: localhost
        login_user: root
        login_password: "{{ mysql_root_password }}"
        name: test
        state: present

    - name: Show database list
      mysql_db:
        login_host: localhost
        login_user: root
        login_password: "{{ mysql_root_password }}"
        state: list
